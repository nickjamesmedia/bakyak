<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>bakyak.ca — coming soon</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@1,800&display=swap" rel="stylesheet">
  <style>
    :root {
      --blue-light: #82C4D8;
      --blue-dark: #3249A2;
      --gold: #EAB534;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      min-height: 100vh;
      background: var(--blue-light);
      color: var(--gold);
      display: grid;
      place-items: center;
      overflow: hidden;
      font-family: 'Barlow', system-ui, -apple-system, 'Segoe UI', Roboto, Ubuntu, 'Helvetica Neue', Arial, sans-serif;
    }

    .headline {
      position: fixed;
      top: clamp(12px, 3vh, 28px);
      left: 50%;
      transform: translateX(-50%);
      font-weight: 800;
      font-style: italic;
      font-size: clamp(22px, 5.5vw, 42px);
      letter-spacing: 0.02em;
      color: var(--gold);
      z-index: 3;
      user-select: none;
      margin: 0;
    }

    .centerpiece {
      position: relative;
      z-index: 4;
      display: grid;
      place-items: center;
      width: 100%;
      padding: clamp(16px, 2vw, 24px);
    }

    #kayakWrap { position: relative; will-change: transform; transform-origin: 50% 50%; display: inline-block; }

    #kayakImg,
    #kayakFallback {
      width: clamp(140px, 28vw, 280px);
      height: auto;
      display: block;
      background: transparent;
    }

    /* Fallback starts truly hidden to avoid flash before CSS */
    #kayakFallback { display: none; position: absolute; inset: 0; }
    #kayakFallback .gold { fill: var(--gold); }
    #kayakFallback .water { fill: var(--blue-light); }

    .waves {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      pointer-events: none;
    }

    .strip:nth-child(odd)  { fill: var(--blue-dark); }
    .strip:nth-child(even) { fill: var(--blue-light); }

    footer {
      position: fixed;
      bottom: 8px;
      left: 12px;
      font-size: 12px;
      color: var(--gold);
      z-index: 5;
      user-select: none;
    }

    @media (prefers-reduced-motion: reduce) {
      #kayakWrap { transition: none !important; }
    }
  </style>
</head>
<body>
  <h1 class="headline">coming soon...</h1>

  <!-- Abstract vertical wave strips (static paths, animated via transforms) -->
  <svg id="waves" class="waves" viewBox="0 0 100 1000" preserveAspectRatio="none" aria-hidden="true">
    <path class="strip" d="M 0 0 L 9 0 C 5 250, 13 750, 9 1000 L 0 1000 Z" />
    <path class="strip" d="M 9 0 C 5 250, 13 750, 9 1000 L 18 1000 C 22 750, 14 250, 18 0 Z" />
    <path class="strip" d="M 18 0 C 14 220, 22 420, 26 500 C 30 580, 20 780, 18 1000 L 27 1000 C 33 770, 29 560, 25 500 C 21 440, 30 240, 27 0 Z" />
    <path class="strip" d="M 27 0 C 22 240, 34 440, 30 500 C 26 560, 26 760, 27 1000 L 36 1000 C 42 760, 38 560, 33 500 C 28 440, 40 240, 36 0 Z" />
    <path class="strip" d="M 36 0 C 30 240, 40 440, 44 500 C 48 560, 36 760, 36 1000 L 45 1000 C 52 760, 47 560, 42 500 C 37 440, 50 240, 45 0 Z" />
    <path class="strip" d="M 45 0 C 40 240, 50 460, 50 500 C 50 540, 40 760, 45 1000 L 54 1000 C 60 760, 56 560, 50 500 C 44 440, 58 240, 54 0 Z" />
    <path class="strip" d="M 54 0 C 48 240, 62 440, 58 500 C 54 560, 50 760, 54 1000 L 63 1000 C 70 760, 64 560, 60 500 C 56 440, 68 240, 63 0 Z" />
    <path class="strip" d="M 63 0 C 58 240, 70 440, 66 500 C 62 560, 62 760, 63 1000 L 72 1000 C 78 760, 72 560, 68 500 C 64 440, 76 240, 72 0 Z" />
    <path class="strip" d="M 72 0 C 66 240, 78 440, 76 500 C 74 560, 66 760, 72 1000 L 81 1000 C 86 760, 82 560, 78 500 C 74 440, 86 240, 81 0 Z" />
    <path class="strip" d="M 81 0 C 76 250, 86 750, 81 1000 L 90 1000 C 94 750, 86 250, 90 0 Z" />
    <path class="strip" d="M 90 0 C 86 250, 98 750, 90 1000 L 100 1000 L 100 0 Z" />
  </svg>

  <main class="centerpiece">
    <div id="kayakWrap" aria-hidden="false">
      <img id="kayakImg" src="assets/emblem.svg" alt="Bakyak emblem — top-down kayak icon" />
      <!-- Fallback oval kayak if emblem fails to load -->
      <svg id="kayakFallback" viewBox="0 0 256 256" role="img" aria-label="Kayak icon fallback" style="display:none; position:absolute; inset:0;">
        <g class="gold">
          <path d="M128 8c-18 24-48 80-48 120s30 96 48 120c18-24 48-80 48-120S146 32 128 8z"/>
          <ellipse class="water" cx="128" cy="128" rx="30" ry="22"/>
          <ellipse class="gold" cx="128" cy="128" rx="22" ry="16"/>
        </g>
      </svg>
    </div>
  </main>

  <footer>© Bak-Yak Inc.</footer>

  <script>
    (function() {
      const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const strips = Array.from(document.querySelectorAll('#waves .strip'));
      const wrap = document.getElementById('kayakWrap');
      const img = document.getElementById('kayakImg');
      const fb = document.getElementById('kayakFallback');

      // Keep fallback truly hidden until an error occurs
      fb.style.display = 'none';
      img.addEventListener('error', () => { img.style.display = 'none'; fb.style.display = 'block'; });

      // --- v0.3: Seek-based follow (decoupled from rotation) ---
      let targetX = 0.5, targetY = 0.5; // pointer (0..1)
      let x = 0.5, y = 0.5;             // kayak position (0..1)
      let vx = 0, vy = 0;               // velocity (units/sec)
      let angle = 0;                    // CSS rotation deg

      const ORIENTATION_OFFSET = -90;   // emblem points up by default
      const MAX_TURN = 22;              // clamp final rotation to +/-
      const TURN_RATE = 180;            // deg/sec limit toward desired
      const SEEK_ACCEL = 2.0;           // accel toward cursor
      const MAX_SPEED = 1.2;            // cap normalized speed
      const DAMP = 2.2;                 // velocity damping per second

      function setTarget(e){
        const r = document.body.getBoundingClientRect();
        targetX = Math.max(0, Math.min(1, (e.clientX - r.left)/r.width));
        targetY = Math.max(0, Math.min(1, (e.clientY - r.top)/r.height));
      }
      window.addEventListener('pointermove', setTarget, {passive:true});
      window.addEventListener('pointerdown', setTarget, {passive:true});

      function wrapDeg(d){ return ((d + 180) % 360) - 180; }

      let last = performance.now();
      function animate(now){
        const dt = Math.min(0.032, (now - last)/1000);
        last = now;

        // --- movement (seek toward target) ---
        const dx = targetX - x;
        const dy = targetY - y;
        const dist = Math.hypot(dx, dy) || 0.0001;
        const ux = dx / dist, uy = dy / dist;
        // small water flow sideways for life
        const t = now * 0.001;
        const flowX = 0.12 * (Math.sin(1.2*t + y*6.0) + 0.6*Math.sin(0.6*t + y*2.2));

        vx += (ux * SEEK_ACCEL + flowX) * dt;
        vy += (uy * SEEK_ACCEL) * dt;

        // damping & speed cap
        const damp = Math.exp(-DAMP * dt);
        vx *= damp; vy *= damp;
        const sp = Math.hypot(vx, vy);
        if (sp > MAX_SPEED) { vx = vx/sp * MAX_SPEED; vy = vy/sp * MAX_SPEED; }

        x += vx * dt; y += vy * dt;
        x = Math.max(0, Math.min(1, x));
        y = Math.max(0, Math.min(1, y));

        // --- rotation (face velocity; fallback to target if slow) ---
        let desired = (sp > 0.02)
          ? Math.atan2(vy, vx) * 180/Math.PI + ORIENTATION_OFFSET
          : Math.atan2(dy, dx) * 180/Math.PI + ORIENTATION_OFFSET;
        desired = wrapDeg(desired);
        // rate-limit then clamp final output range
        const maxStep = TURN_RATE * dt;
        let diff = wrapDeg(desired - angle);
        if (diff >  maxStep) diff =  maxStep;
        if (diff < -maxStep) diff = -maxStep;
        angle = wrapDeg(angle + diff);
        if (angle >  MAX_TURN) angle =  MAX_TURN;
        if (angle < -MAX_TURN) angle = -MAX_TURN;

        // Apply transform
        const maxX = 36, maxY = 20; // px travel from center
        const tx = (x - 0.5) * maxX * 2;
        const ty = (y - 0.5) * maxY * 2;
        wrap.style.transform = `translate(${tx}px, ${ty}px) rotate(${angle}deg)`;

        // --- waves: abstract interference, amplitude scales a touch with speed; biased by kayak x ---
        const sway = (x - 0.5) * 6;
        const amp = 1 + Math.min(1, sp / MAX_SPEED) * 0.6;
        strips.forEach((p, i) => {
          const phase = i * 0.55;
          const off = (Math.sin(1.1*t + phase) * 2.2 + Math.sin(0.6*t + phase*1.7) * 1.0) * amp + sway;
          p.setAttribute('transform', `translate(${off},0)`);
        });

        if (!reduce) requestAnimationFrame(animate);
      }

      if (!reduce) requestAnimationFrame(animate);
    })();
  </script>
</body>
</html>
