<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BakYak — Collapsible Kayak Backpack | Coming Soon</title>

  <!-- Responsive / SEO basics -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="BakYak (Bak-Yak Inc.) — the collapsible kayak you carry as a backpack. Coming soon." />
  <link rel="canonical" href="https://bakyak.ca/">
  <meta name="theme-color" content="#C8692D" />

  <!-- CSP for single-file demo (canvas + inline script). 
       If you externalize JS/CSS, remove 'unsafe-inline' and whitelist files. -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self';
                 img-src 'self' data:;
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
                 font-src https://fonts.gstatic.com;
                 script-src 'self' 'unsafe-inline';
                 frame-ancestors 'none'">

  <!-- Barlow for the masthead -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@1,700&display=swap" rel="stylesheet">

  <style>
    /* =========================
       THEME / COLOR VARIABLES
       ========================= */
    :root{
      /* Lake palette (greenish-blue, darker forest wave ribbons) */
      --light:#87CBB4;   /* water background + logotype fill */
      --dark:#1E4D3A;    /* wave bands + outlines */
      --text:#8A3F00;    /* darker brand orange for text/UI */
      --kayak:#C8692D;   /* brighter brand orange for kayak */
    }

    /* Global base styles */
    html,body{
      height:100%;
      margin:0;
      background:var(--light);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      text-rendering:optimizeLegibility;

      /* Mobile overflow fix */
      overflow:hidden;
      overscroll-behavior:none;
      touch-action:manipulation;
    }

    /* Root container fills the *dynamic* viewport (no scroll jump on URL bar) */
    .wrap{
      position:fixed; inset:0;
      width:100%;
      height:100dvh;
      overflow:hidden;
    }

    /* "coming soon…" masthead at top center */
    .mast{
      position:fixed;top:12px;left:50%;transform:translateX(-50%);
      font:italic 700 28px/1 "Barlow",system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      letter-spacing:.02em;user-select:none;text-shadow:0 1px 0 #ffffff66; z-index:3;
      pointer-events:none;
    }

    /* Main canvas for water + wake + coins */
    #game{width:100%;height:100%;display:block;touch-action:manipulation; z-index:0;}

    /* =========================
       BOAT OVERLAY (inline SVGs)
       ========================= */
    #boat{
      position:fixed; left:0; top:0; width:0; height:0; z-index:1;
      pointer-events:none; /* clicks go to canvas/UI, not to the SVGs */
      will-change: transform;
    }
    .sprite{
      /* Center the SVGs on the boat transform, and rotate so “forward” is +X */
      position:absolute; left:0; top:0;
      transform: translate(-50%,-50%) rotate(90deg);
      will-change: transform, opacity;
      display:block;
    }
    #svgLogotype{ opacity:1; } /* JS animates this in/out */
    #svgKayak{ opacity:1; }    /* Always visible */

    /* Kayak brand color; cutouts preserved with evenodd rules on <path> (see inline SVG) */
    #svgKayak path{ fill: var(--kayak); }

    /* Logotype letters = lake green (override any inline fill styles) */
    #svgLogotype path{ fill: var(--light) !important; }

    /* Outline the logotype during full idle AND while recentering (TRANSITION) */
    body.idle #svgLogotype path,
    body.recenter #svgLogotype path{
      stroke: var(--dark);
      stroke-width: 3px;
      vector-effect: non-scaling-stroke;
      paint-order: stroke fill;
      stroke-linejoin: round;
      stroke-linecap: round;
    }

    /* =========================
       HINT BUBBLE
       ========================= */
    .hint{
      position:fixed;left:12px;bottom:12px;
      font:600 12px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,
           "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",sans-serif;
      color:var(--text);
      background:#ffffff66;
      padding:6px 8px;border-radius:6px;
      user-select:none;backdrop-filter:blur(4px);
      opacity:0;transition:opacity .8s ease; z-index:3;
      max-width: 520px;
      white-space: normal; /* allow wrapping */
    }
    .hint.show{opacity:.9;}

    /* On small screens, constrain width so it naturally wraps to ~2 lines */
    @media (max-width: 480px){
      .hint{ max-width: 240px; }
    }

    /* Footer copyright */
    .copy{
      position:fixed;right:12px;bottom:10px;
      font:600 12px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      color:var(--text);text-shadow:0 1px 0 #ffffff66;user-select:none; z-index:3;
      pointer-events:none;
    }

    /* =========================
       SCORE CARDS (stacked, auto-hide)
       ========================= */
    #scoreStack{
      position:fixed; top:12px; right:12px; z-index:3;
      display:flex; flex-direction:column; gap:8px;
      align-items:flex-end;
      pointer-events:none;  /* informational only */
    }

    .scorecard{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px; border-radius:8px;
      background:#ffffff66; backdrop-filter:blur(4px);
      color:var(--text);
      font-weight:600; font-size:13px; line-height:1.2;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,
                   "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",sans-serif;
      opacity:0; transform:translateY(-6px) scale(.98);
      transition:opacity .35s ease, transform .35s ease;
      min-width: 64px;
    }
    .scorecard.show{ opacity:.95; transform:translateY(0) scale(1); }
    .scorecard.pop{ animation:score-pop .35s ease-out; }

    @keyframes score-pop{
      0%{transform:translateY(0) scale(1)}
      35%{transform:translateY(-2px) scale(1.12)}
      100%{transform:translateY(0) scale(1)}
    }

    /* =========================
       INFO BUTTON + PANEL (text in orange, no outline)
       ========================= */
    .text-brand-outline{
      color: var(--text);
      /* subtle drop shadow for readability */
      text-shadow: 0 1px 1px rgba(0,0,0,.28);
    }

    #infoBtn{
      position:fixed; top:12px; left:12px; z-index:4;
      padding:6px 10px; border-radius:8px;
      background:#ffffff99; backdrop-filter:blur(4px);
      border:none; cursor:pointer;
      font:600 13px/1 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    }
    /* apply orange to button label (no outline) */
    #infoBtn.text-brand-outline{}

    #infoBtn:active{ transform: translateY(1px); }

    /* Overlay covers view; clicking outside the panel closes it. */
    #infoOverlay{
      position:fixed; inset:0; z-index:4;
      display:none; /* toggled by JS */
      background: rgba(255,255,255,0.10);
      backdrop-filter: blur(3px);
    }
    #infoOverlay.show{ display:block; }

    /* Panel floats near top-left; translucent white background */
    #infoPanel{
      position:absolute; top:56px; left:12px;
      max-width: 420px;
      background: rgba(255,255,255,0.85);
      border-radius:12px;
      box-shadow:0 8px 32px rgba(0,0,0,.15);
      padding:14px 16px 12px;
      pointer-events:auto;
    }
    #infoPanel h3{
      margin:0 0 6px; font:700 16px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    }
    #infoPanel p{
      margin:0 0 8px; font:600 13px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
    }
    /* make the panel text orange with subtle drop shadow */
    #infoPanel h3, #infoPanel p{
      color:var(--text);
      text-shadow: 0 1px 1px rgba(0,0,0,.28);
    }

    #infoClose{
      position:absolute; top:6px; right:6px;
      width:28px; height:28px; border:none; border-radius:6px;
      background:#00000010; color:#000; font:700 15px/1 "system-ui";
      cursor:pointer;
    }

    /* =========================
       EMAIL SIGNUP PLACEHOLDER
       ========================= */
    #signup{
      position:fixed; left:50%; transform:translateX(-50%);
      bottom:56px; z-index:3;
      display:flex; flex-wrap:wrap; gap:8px; align-items:center; justify-content:center;
      padding:8px 10px; border-radius:10px;
      background:#ffffff80; backdrop-filter:blur(4px);
      max-width: 92vw;
    }
    #signup p{
      margin:0; flex: 1 1 100%;
      font:700 13px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      text-align:center;
      /* orange with subtle drop shadow */
      color:var(--text);
      text-shadow: 0 1px 1px rgba(0,0,0,.28);
    }
    #email{
      flex: 1 1 240px;
      min-width: 180px;
      padding:8px 10px; border-radius:8px; border:1px solid #00000022;
      font:500 13px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      color:#111; background:#fff; /* inputs remain readable black */
    }
    #subscribe{
      padding:8px 12px; border-radius:8px; border:none; cursor:pointer;
      font:700 13px/1 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      color:#fff; background:var(--text);
    }
    #subscribe:active{ transform:translateY(1px); }

    @media (prefers-reduced-motion: reduce){
      #game{animation:none;}
      .scorecard{transition:none;}
    }
  </style>
</head>
<body class="idle">
  <div class="wrap" aria-label="BakYak coming soon interactive scene">

    <!-- Top-center masthead -->
    <div class="mast" aria-hidden="true">coming soon…</div>

    <!-- The canvas draws water, waves, wake, coins, ripples -->
    <canvas id="game"></canvas>

    <!-- Boat overlay: inline SVGs rendered together and transformed as one -->
    <div id="boat" aria-hidden="true">
      <!-- KAYAK (emblem). fill-rule=evenodd keeps cutouts visible -->
      <svg id="svgKayak" class="sprite" viewBox="0 0 4500 4375" width="0" height="0" role="img" aria-label="BakYak kayak emblem">
        <g>
          <g>
            <path fill-rule="evenodd" d="M1832.3,2052.63c-24.599,-0 -48.166,-9.887 -65.402,-27.438c-17.236,-17.552 -26.695,-41.294 -26.249,-65.889c2.081,-112.555 5.885,-217.858 11.215,-310.596c0.814,-14.161 4,-32.593 16.806,-48.735c2.707,-32.251 11.249,-134.213 15.063,-152.434c3.518,-16.809 6.724,-22.487 27.147,-26.281c1.509,-166.063 40.168,-469.162 91.308,-602.986c5.625,-14.718 14.175,-17.66 31.646,-17.673c16.847,-119.347 123.719,-327.067 208.611,-477.478c21.136,-37.304 62.505,-60.622 107.554,-60.622c45.048,0 86.418,23.318 107.553,60.622c84.893,150.411 191.765,358.131 208.612,477.478c17.471,0.013 26.021,2.955 31.646,17.673c51.14,133.824 89.799,436.923 91.308,602.986c20.423,3.794 23.629,9.472 27.147,26.281c3.814,18.221 12.356,120.183 15.063,152.434c12.806,16.142 15.992,34.574 16.806,48.735c5.33,92.738 9.134,198.041 11.21,310.596c0.445,24.594 -9.013,48.335 -26.248,65.885c-17.235,17.55 -40.801,27.436 -65.398,27.436c-11.29,0.006 -22.728,0.006 -33.755,0.006c-43.467,-0 -80.957,-30.527 -89.765,-73.091c-44.696,-216.145 -159.636,-369.945 -294.179,-369.945c-134.543,0 -249.483,153.8 -294.479,369.883c-8.779,42.422 -46.144,72.847 -89.465,72.847c-11.027,0.306 -22.465,0.306 -33.755,0.306Zm834.447,269.736c24.649,0 48.26,9.927 65.503,27.54c17.243,17.614 26.667,41.43 26.143,66.073c-2.066,94.087 -5.305,188.439 -9.811,280.644c-1.821,37.27 -10.353,56.173 -18.271,67.174c1.547,18.429 -6.878,125.041 -13.335,146.651c-6.457,21.61 -9.611,27.905 -26.614,31.832c-3.588,103.152 -52.8,465.98 -59.275,494.662c-7.405,32.799 -21.738,88.705 -33.514,108.663c-3.793,6.428 -8.261,16.293 -30.894,20.492c-19.992,100.664 -83.253,269.073 -159.431,401.708c-17.177,29.908 -34.604,59.26 -51.293,86.787c-21.62,35.787 -62.093,57.906 -105.956,57.906c-43.863,-0 -84.336,-22.119 -105.955,-57.906c-16.69,-27.527 -34.117,-56.879 -51.294,-86.787c-76.178,-132.635 -139.439,-301.044 -159.431,-401.708c-22.633,-4.199 -27.101,-14.064 -30.894,-20.492c-11.776,-19.958 -26.109,-75.864 -33.514,-108.663c-6.475,-28.682 -55.687,-391.51 -59.275,-494.662c-17.003,-3.927 -20.157,-10.222 -26.614,-31.832c-6.457,-21.61 -14.882,-128.222 -13.335,-146.651c-7.918,-11.001 -16.45,-29.904 -18.271,-67.174c-4.506,-92.205 -7.745,-186.557 -9.808,-280.644c-0.523,-24.642 8.9,-48.457 26.143,-66.07c17.242,-17.613 40.852,-27.539 65.5,-27.539c11.796,-0.004 23.754,-0.004 35.244,-0.004c43.054,0 80.306,29.964 89.535,72.018c46.169,210.707 159.579,359.624 291.969,359.624c132.39,0 245.8,-148.917 292.266,-359.559c9.198,-41.914 46.327,-71.778 89.238,-71.778c11.49,-0.305 23.448,-0.305 35.244,-0.305Z"/>
            <path fill-rule="evenodd" d="M3195.34,2231.01l-1890.68,-0c-64.501,-0 -126.359,3.69 -171.968,10.258c-45.609,6.568 -96.854,42.972 -142.462,49.54c-45.609,6.568 -107.467,10.258 -171.967,10.258l-222.321,-0c-70.274,-0 -127.242,-50.845 -127.242,-113.562c0,-62.717 56.968,-113.562 127.242,-113.562l222.321,0c64.5,0 126.358,3.69 171.967,10.258c45.608,6.568 96.853,42.972 142.462,49.54c45.609,6.568 107.467,10.258 171.968,10.258l1890.68,0c64.501,0 126.359,-3.69 171.968,-10.258c45.609,-6.568 96.854,-42.972 142.462,-49.54c45.609,-6.568 107.467,-10.258 171.967,-10.258l222.321,0c70.274,0 127.242,50.845 127.242,113.562c-0,62.717 -56.968,113.562 -127.242,113.562l-222.321,-0c-64.5,-0 -126.358,-3.69 -171.967,-10.258c-45.608,-6.568 -96.853,-42.972 -142.462,-49.54c-45.609,-6.568 -107.467,-10.258 -171.968,-10.258Z"/>
          </g>
        </g>
      </svg>

      <!-- LOGOTYPE (full inline SVG with original groups) -->
      <svg id="svgLogotype" class="sprite" viewBox="0 0 1080 1050" width="0" height="0" role="img" aria-label="BakYak logotype">
        <g transform="matrix(1,0,0,1,-13803,-1101)">
          <g id="logotype" transform="matrix(1,0,0,1,1312,6.0668e-14)">
            <rect x="12491" y="1101" width="1080" height="1050" style="fill:none;"/>
            <g transform="matrix(0.50082,0,0,0.50082,6290.28,599.305)">
              <g transform="matrix(2.12314,0,-0.48463,2.09917,12534.2,954.032)">
                <path d="M307.72,254.78C307.719,254.785 307.717,254.791 307.716,254.796C307.475,255.742 308.05,256.718 308.991,256.958C308.994,256.959 308.997,256.959 309,256.96C319.73,259.63 329.63,263.06 339.76,268.27C362.01,279.74 375.18,301.14 376.04,325.99C376.433,337.523 375.08,349.95 371.98,363.27C366.873,385.21 357.177,404.633 342.89,421.54C327.08,440.25 305.46,453.9 281.97,463.48C254.08,474.85 223.16,481.63 192.77,480.81C174.41,480.32 155.05,475.94 140.97,464.29C129.46,454.77 123.05,440.22 121.25,425.25C119.91,414.09 120.63,402.383 123.41,390.13C126.32,377.3 130.68,363.52 133.57,351.69C140.43,323.717 144.177,295.573 144.81,267.26C145.15,252.28 143.843,238.217 140.89,225.07C138.85,215.983 136.647,207.613 134.28,199.96C131.64,191.43 126.48,178.01 123.43,166.08C115.91,136.72 139.92,116.53 167.25,115.74C199.21,114.81 237.27,110.31 263.75,108.38C271.69,107.807 282.437,107.76 295.99,108.24C324.75,109.27 352.16,117.08 366.07,144.44C375.53,163.04 376.79,184.34 367.66,203.3C362.21,214.62 355.79,224.21 345.98,231.47C334.84,239.72 318.35,247.8 309.99,252.47C308.69,253.203 307.933,253.973 307.72,254.78ZM215.9,224.17C216.62,242.33 234.88,244.89 248.07,238.56C267.27,229.33 282,206.53 283.05,185.51C283.4,178.37 281.89,170.58 276.7,165.66C273.847,162.947 270.963,161.107 268.05,160.14C252.39,154.96 239.31,162 230.74,175.24C221.65,189.27 215.23,207.18 215.9,224.17ZM279.39,367.19C298.76,344.79 296.68,311.65 272.38,293.63C266.97,289.61 258.05,286.33 251.08,287.11C232.36,289.22 220.74,305.44 217.02,322.57C214.867,332.457 214.353,342.78 215.48,353.54C217.19,369.91 225.14,383.07 242.52,385.65C256.69,387.75 270.6,377.34 279.39,367.19Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
              </g>
              <g transform="matrix(1.94679,-6.92509e-16,0.465824,1.98835,12139.1,195.87)">
                <path d="M808.01,643C805.3,649.45 805.04,655.64 810.94,660.26C816.68,664.74 822.94,668.05 829.72,670.19C833.753,671.463 836.49,672.56 837.93,673.48C850.03,681.18 852.21,692.76 853.35,706.25C854.597,721.07 855.31,729.153 855.49,730.5C856.59,738.7 858.53,747.18 864.44,752.73C870.987,758.883 878.473,760.537 886.9,757.69C896.61,754.41 905.75,745.61 916.27,754.43C924.15,761.05 925.28,768.82 925.78,779.25C926.67,797.71 923.43,815.96 917.15,832.47C910.997,848.683 900.93,862.483 886.95,873.87C873.02,885.22 852.53,889.67 835.49,883.74C826.83,880.727 819.507,876.713 813.52,871.7C799.81,860.2 792.07,840.2 789.16,822.28C788,815.167 787.26,808.49 786.94,802.25C786.06,785.283 785.81,763.617 786.19,737.25C786.317,728.45 785.23,720.327 782.93,712.88C781.38,707.9 776.86,703.88 771.42,702.38C765.09,700.64 757.11,700.14 751.41,703.52C743.14,708.44 740.15,722.13 739.39,730.9C738.257,744.067 739.073,756.573 741.84,768.42C745.82,785.42 751.55,797.77 760.08,819.36C762.147,824.573 763.67,831.257 764.65,839.41C766.56,855.22 762.93,868.82 749.78,877.75C746.98,879.657 742.51,881.847 736.37,884.32C729.69,887.013 723.153,888.5 716.76,888.78C709.087,889.107 700.833,889.033 692,888.56C680.907,887.967 670.17,885.613 659.79,881.5C651.34,878.16 644.41,873.6 639.48,866.27C633.247,856.99 631.107,846.737 633.06,835.51C634.2,828.943 636.283,821.953 639.31,814.54C640.91,810.6 645.067,800.683 651.78,784.79C657.627,770.93 662.393,756.703 666.08,742.11C670.38,725.077 672.943,707.457 673.77,689.25C675.077,660.697 674.533,633.35 672.14,607.21C671.647,601.85 670.46,595.053 668.58,586.82C665.96,575.36 660.67,559.75 657.45,550.04C654.99,542.64 653.723,536.907 653.65,532.84C653.24,510.76 673.79,500.21 692.95,497.1C695.577,496.673 700.787,496.233 708.58,495.78C717.86,495.24 727.187,495.097 736.56,495.35C740.767,495.47 744.8,496.21 748.66,497.57C768.81,504.69 771.06,523.33 764.51,541.31C760.737,551.663 756.187,563.6 750.86,577.12C749.833,579.713 748.393,584.257 746.54,590.75C743.4,601.723 742.023,612.723 742.41,623.75C742.79,634.61 753.43,638.7 762.36,634.6C763.973,633.853 766.1,631.977 768.74,628.97C775.7,621.05 779.26,612.09 783.19,601.7C793.18,575.3 800.62,554.05 812.8,532.3C821.75,516.31 834.36,503.76 851.91,498.72C862.68,495.62 875.47,495.76 886.68,497.81C896.23,499.55 908.17,504.7 914.18,512.36C925.37,526.58 923.2,547.88 912.44,561.89C905.18,571.35 892.16,575.06 881,577.79C877.053,578.757 873.723,579.79 871.01,580.89C856.803,586.623 845.333,593.95 836.6,602.87C825.06,614.66 814.21,628.28 808.01,643Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
              </g>
              <g transform="matrix(2.08359,6.88809e-17,-0.346709,1.96628,12600.6,1192.28)">
                <path d="M742.81,623.54C742.76,632.15 748.2,634.14 755.75,633.35C761.077,632.783 765.31,631.307 768.45,628.92C777.66,621.91 782.04,609.94 785.34,599.81C792.32,578.37 798.02,560.58 807.51,541.74C814.74,527.36 822.74,514.96 835.37,506.26C845.817,499.067 856.893,494.457 868.6,492.43C874.48,491.41 879.74,491.03 885.67,492.15C906.01,495.99 922.52,507.82 924.74,529.75C925.68,539.12 923.59,549.57 918.6,557.62C912.91,566.78 902.92,574.3 892.01,576.5C888.62,577.18 883.04,578.5 878.9,579.89C860.37,586.12 842.46,595.41 828.95,608.96C821.82,616.11 797.15,643.91 804.58,654.48C806.227,656.813 808.287,658.663 810.76,660.03C819.94,665.08 827.41,667.2 840.69,671.55C843.903,672.603 847.603,674.393 851.79,676.92C860.33,682.07 861.05,688.19 861.36,697.15C861.42,698.817 861.747,706.21 862.34,719.33C862.613,725.363 863.483,730.6 864.95,735.04C866.523,739.78 869.543,743.08 874.01,744.94C877.16,746.26 882.7,748.27 886.34,747.09C890.49,745.74 894.86,741.59 898.86,740.42C902.88,739.24 907.57,739.02 911.16,741.87C919.23,748.28 923.52,758.19 924.92,768.28C929.9,804.32 919.83,845.37 891.47,870.44C871.78,887.83 846.35,891.54 822.91,878.04C815.163,873.58 809.093,867.75 804.7,860.55C799.507,852.05 795.72,843.087 793.34,833.66C787.59,810.84 788.27,786.09 789.37,762.75C789.843,752.717 789.84,743.113 789.36,733.94C788.92,725.58 787.153,718.007 784.06,711.22C780.32,703 767.6,696.72 759.02,696.53C752.09,696.37 748.71,699.61 745.94,706.01C741.02,717.343 738.823,728.67 739.35,739.99C739.597,745.243 740.563,751.42 742.25,758.52C746.01,774.3 750.85,785.33 759.09,806.19C760.017,808.55 761.563,813.497 763.73,821.03C767.87,835.44 767.62,855.04 759.66,867.8C745.78,890.09 713.32,892.93 690.38,887.86C680.62,885.71 670.37,880.91 667.62,870.41C666.11,864.62 667.62,859.43 669.89,852.01C675.81,832.72 674.54,813.33 668.8,794.45C668.133,792.25 665.983,785.82 662.35,775.16C660.73,770.393 659.993,764.677 660.14,758.01C660.16,756.83 660.863,752.9 662.25,746.22C662.743,743.813 663.727,739.94 665.2,734.6C669.66,718.4 672.8,704.3 673.93,688.25C675.94,660.02 674.92,631.95 671.93,605.51C670.903,596.423 668.957,587.14 666.09,577.66C666.003,577.373 662.747,567.203 656.32,547.15C649.55,526 651.62,504.37 675.54,496.29C688.89,491.78 702.91,491.44 717.99,492.37C727.583,492.97 736.68,494.35 745.28,496.51C751.267,498.017 756.487,500.47 760.94,503.87C768.66,509.77 772.73,522.8 770.03,532.26C765.74,547.29 757.7,565.11 753.95,574.92C749.177,587.393 745.927,598.08 744.2,606.98C743.307,611.62 742.843,617.14 742.81,623.54Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
              </g>
              <g transform="matrix(1.893,0,0.564547,1.95757,12067.8,1195.76)">
                <path d="M301.41,705.33C298.08,703.17 294.58,704.68 291.34,706.85C285.28,710.9 280.75,714.34 275.24,716.91C264.027,722.13 252.06,724.377 239.34,723.65C221.69,722.63 203.6,716.64 192.26,703.42C177.68,686.41 174.65,666.24 170.45,645.28C167.34,629.7 161.02,618.36 150.85,606.11C149.83,604.883 142.933,596.96 130.16,582.34C113.11,562.83 103.85,527.1 125.66,506.9C138.2,495.28 156.82,491.91 173.51,491.88C192.45,491.833 211.563,494.08 230.85,498.62C238.643,500.453 245.553,503.377 251.58,507.39C262.45,514.63 265.16,527.71 263.29,540.26C261.26,553.81 257.94,563.49 252.99,579.73C248.65,593.98 245.5,611.31 247.39,626.85C248.32,634.53 251.64,640.75 257.89,645.61C271.98,656.57 290.14,652.96 301.86,640.46C312.64,628.973 317.19,615.273 315.51,599.36C315.23,596.76 314.547,593.003 313.46,588.09C311.71,580.17 309.63,573.43 307.37,565.69C302.54,549.15 299.69,530.29 306.28,515.01C310.06,506.24 317.57,501.48 326.39,498.41C341.71,493.077 358.603,491.48 377.07,493.62C385.97,494.647 393.757,496.863 400.43,500.27C414.06,507.21 419.06,520.06 415.36,534.54C412.27,546.6 405.17,557.27 397.72,567.23C389.887,577.703 383.173,586.9 377.58,594.82C369.48,606.28 363.3,617.47 359.98,631.09C357.707,640.437 356.517,649.863 356.41,659.37C356.283,670.123 356.563,679.667 357.25,688C359.62,716.94 361.67,733.82 361.06,757.38C360.793,767.833 359.997,776.74 358.67,784.1C355.19,803.433 348.11,821.257 337.43,837.57C320.78,863.01 298.23,879.69 269.07,887.56C236.04,896.48 198.38,891.98 168.06,878.7C153.73,872.43 140.5,861.13 132.13,847.32C123.557,833.187 119.48,817.773 119.9,801.08C120.62,772.2 136.25,744.19 165.61,736.97C170.39,735.797 177.363,735.157 186.53,735.05C197.52,734.92 208.26,735.35 217.16,740.78C224.46,745.24 225.84,753.35 222.51,760.9C221.477,763.247 220.493,765.22 219.56,766.82C216.08,772.8 215.08,779.93 217.39,786.39C219.91,793.45 226.81,797.56 233.73,799.03C254.66,803.49 273.23,796.39 287.35,780.62C295.757,771.22 301.33,760.043 304.07,747.09C306.417,735.963 307.23,725.003 306.51,714.21C306.257,710.343 304.557,707.383 301.41,705.33Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
              </g>
              <g transform="matrix(5.79828,0,-2.40976e-15,5.79828,12009.5,-5850.55)">
                <path d="M385.926,1417.81C385.968,1417.81 386.003,1417.82 386.032,1417.84C386.061,1417.87 386.076,1417.9 386.076,1417.94L386.076,1418.8C386.076,1418.84 386.061,1418.87 386.032,1418.9C386.003,1418.93 385.968,1418.94 385.926,1418.94L383.631,1418.94C383.59,1418.94 383.569,1418.96 383.569,1419L383.569,1425.53C383.569,1425.56 383.554,1425.6 383.525,1425.62C383.496,1425.65 383.461,1425.66 383.419,1425.66L382.272,1425.66C382.231,1425.66 382.195,1425.65 382.166,1425.62C382.137,1425.6 382.122,1425.56 382.122,1425.53L382.122,1419C382.122,1418.96 382.102,1418.94 382.06,1418.94L379.853,1418.94C379.811,1418.94 379.776,1418.93 379.747,1418.9C379.718,1418.87 379.703,1418.84 379.703,1418.8L379.703,1417.94C379.703,1417.9 379.718,1417.87 379.747,1417.84C379.776,1417.82 379.811,1417.81 379.853,1417.81L385.926,1417.81Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
                <path d="M392.847,1417.89C392.889,1417.84 392.947,1417.81 393.022,1417.81L394.169,1417.81C394.211,1417.81 394.246,1417.82 394.275,1417.84C394.304,1417.87 394.319,1417.9 394.319,1417.94L394.319,1425.53C394.319,1425.56 394.304,1425.6 394.275,1425.62C394.246,1425.65 394.211,1425.66 394.169,1425.66L393.022,1425.66C392.98,1425.66 392.945,1425.65 392.916,1425.62C392.887,1425.6 392.872,1425.56 392.872,1425.53L392.872,1420.17C392.872,1420.15 392.862,1420.14 392.841,1420.13C392.82,1420.12 392.806,1420.13 392.797,1420.15L391.238,1422.31C391.197,1422.37 391.139,1422.4 391.064,1422.4L390.49,1422.4C390.415,1422.4 390.357,1422.37 390.316,1422.31L388.744,1420.16C388.736,1420.14 388.721,1420.13 388.701,1420.14C388.68,1420.15 388.67,1420.16 388.67,1420.18L388.67,1425.53C388.67,1425.56 388.655,1425.6 388.626,1425.62C388.597,1425.65 388.561,1425.66 388.52,1425.66L387.373,1425.66C387.331,1425.66 387.296,1425.65 387.267,1425.62C387.237,1425.6 387.223,1425.56 387.223,1425.53L387.223,1417.94C387.223,1417.9 387.237,1417.87 387.267,1417.84C387.296,1417.82 387.331,1417.81 387.373,1417.81L388.52,1417.81C388.595,1417.81 388.653,1417.84 388.694,1417.89L390.727,1420.67C390.744,1420.68 390.76,1420.69 390.777,1420.69C390.794,1420.69 390.806,1420.68 390.814,1420.67L392.847,1417.89Z" style="fill:rgb(130,196,216);fill-rule:nonzero;"/>
              </g>
            </g>
          </g>
        </g>
      </svg>
    </div>

    <!-- Hint + Footer -->
    <div class="hint" id="hint">Click or tap to move the kayak and pick up coins</div>
    <div class="copy">© <span id="year"></span> Bak-Yak Inc.</div>

    <!-- Score stack: separate cards; auto-hide after 2s without change -->
    <div id="scoreStack" aria-live="polite">
      <div id="cardCoins" class="scorecard" aria-hidden="true">
        <span aria-hidden="true">💰</span><span id="scoreCount">0</span>
      </div>
      <div id="cardMiss" class="scorecard" aria-hidden="true">
        <span aria-hidden="true">☹️</span><span id="missCount">0</span>
      </div>
    </div>

    <!-- Info button (orange with outline) -->
    <button id="infoBtn" class="text-brand-outline" type="button" aria-haspopup="dialog" aria-controls="infoOverlay">More info</button>

    <!-- Info overlay (click outside panel or ✕ to close; any click still moves kayak) -->
    <div id="infoOverlay" role="dialog" aria-modal="true" aria-labelledby="infoTitle">
      <div id="infoPanel">
        <button id="infoClose" type="button" aria-label="Close">✕</button>
        <h3 id="infoTitle">BakYak — a kayak on your back</h3>
        <p><strong>Bak‑Yak Inc.</strong> is building a collapsible kayak that carries like a backpack and assembles in minutes.</p>
        <p>This chill scene is a tiny canvas minigame: nudge the kayak with your clicks, ride the waves, and pick up coins.</p>
        <p>Follow along here while we get ready to launch.</p>
      </div>
    </div>

    <!-- Email signup placeholder (orange text w/ outline) -->
    <form id="signup" autocomplete="on">
      <p>Be one of the first to get your BakYak.</p>
      <input id="email" name="email" type="email" inputmode="email" placeholder="yourname@email.com" aria-label="Email address">
      <button id="subscribe" type="submit">Subscribe</button>
    </form>
  </div>

  <noscript>This page is interactive. Enable JavaScript to play with the kayak.</noscript>

  <script>
  (() => {
    'use strict';

    /* ==========================================================
       HELPERS / CONSTANTS
       ========================================================== */
    const COLOR_LIGHT = css('--light','#87CBB4');  // water background + logotype fill
    const COLOR_DARK  = css('--dark', '#1E4D3A');  // wave ribbons + outline

    function css(v,f){ const x=getComputedStyle(document.documentElement).getPropertyValue(v).trim(); return x||f; }
    function clamp(v,lo,hi){ return Math.max(lo,Math.min(hi,v)); }
    const mm = (q)=> (typeof matchMedia==='function' ? matchMedia(q) : {matches:false, addEventListener:()=>{}, removeEventListener:()=>{}});

    /* ==========================================================
       CANVAS SETUP
       ========================================================== */
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    let dpr = Math.max(1, Math.min(3, window.devicePixelRatio||1));
    let width=0, height=0;

    /* Timebase */
    let timeSec = 0, last = performance.now();
    const prefersReduce = mm('(prefers-reduced-motion: reduce)').matches;

    /* ==========================================================
       RESPONSIVE BOAT SIZE
       ========================================================== */
    const BASE_LENGTH_DESKTOP = 125;
    const BASE_LENGTH_MOBILE  = BASE_LENGTH_DESKTOP * 0.5;
    const mobileMQ = mm('(max-width: 640px)');
    let targetLength = mobileMQ.matches ? BASE_LENGTH_MOBILE : BASE_LENGTH_DESKTOP;
    let currentLength = targetLength;       // eased render size
    const SIZE_EASE_PER_SEC = 6;            // exp easing rate (higher=faster)
    mobileMQ.addEventListener?.('change', (e)=>{
      targetLength = e.matches ? BASE_LENGTH_MOBILE : BASE_LENGTH_DESKTOP;
    });

    /* ==========================================================
       BOAT / STATE MACHINE
       ========================================================== */
    const NORTH = -Math.PI/2;
    const MODE = { LOGO_IDLE:'LOGO_IDLE', PRE_IDLE:'PRE_IDLE', TRANSITION:'TRANSITION', ACTIVE:'ACTIVE' };
    let mode = MODE.LOGO_IDLE;              // start in idle (logo visible)
    let lastUserTime = 0;
    const IDLE_AFTER = 12;                  // seconds before pre-idle
    const PRE_IDLE_WINDOW = 2.5;            // soft lead-in before full idle
    const IDLE_DIST = 0.5;                  // "close enough" to target

    /* Boat parameters */
    const kayak = {
      x:0, y:0,
      angle:NORTH,
      tx:0, ty:0,
      maxSpeed:260,
      arriveGain:2.0,
      rollAmp:0.03, rollSpeed:0.8, // side roll (~±3.4°)
      heaveAmp:0.4,                // small vertical heave (px)
      speed:0,
      turnRate:2.5
    };
    let initialized=false;

    /* Logotype fade */
    let logoAlpha = 1;
    let logoAlphaTarget = 1;
    const LOGO_FADE_IN_RATE  = 2.2; // fade IN
    const LOGO_FADE_OUT_RATE = 3.0; // fade OUT (~1s)

    /* ==========================================================
       WAKE (trail) — only when ACTIVE & moving fast
       ========================================================== */
    const wake = { points:[], maxAge:1.6, minSpeed:40 };

    /* ==========================================================
       COINS & SCORE
       ========================================================== */
    const cardCoinsEl = document.getElementById('cardCoins');
    const cardMissEl  = document.getElementById('cardMiss');
    const scoreCount  = document.getElementById('scoreCount');
    const missCountEl = document.getElementById('missCount');

    let score = 0;
    let missed = 0;

    let coinsEnabled = false;     // do not spawn until the first user click
    const coin = { active:false, x:0, y:0, r:16, spawnAt:0, expiresAt:0, targeted:false };
    let nextSpawnAt = Number.POSITIVE_INFINITY; // scheduled after first click
    const COIN_MIN = 6, COIN_MAX = 9;           // seconds (spawn & lifetime)
    const randSpan = () => COIN_MIN + Math.random()*(COIN_MAX-COIN_MIN);

    // Score cards: auto-hide timers
    let coinsHideTimer = null, missHideTimer = null;
    function showCard(cardEl){
      if (!cardEl.classList.contains('show')){
        cardEl.classList.add('show');
      }
      // re-trigger pop animation
      cardEl.classList.remove('pop');
      requestAnimationFrame(()=>cardEl.classList.add('pop'));
    }
    function scheduleHideCard(cardEl, which){
      if (which==='coins'){ if (coinsHideTimer) clearTimeout(coinsHideTimer);
        coinsHideTimer = setTimeout(()=>cardEl.classList.remove('show'), 2000);
      }else{
        if (missHideTimer) clearTimeout(missHideTimer);
        missHideTimer = setTimeout(()=>cardEl.classList.remove('show'), 2000);
      }
    }

    /* ==========================================================
      RESIZE HANDLER
      ========================================================== */
    function resize(){
      dpr = Math.max(1, Math.min(3, window.devicePixelRatio||1));
      const w = canvas.clientWidth, h = canvas.clientHeight;
      canvas.width = Math.round(w*dpr); canvas.height = Math.round(h*dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
      width=w; height=h;

      if(!initialized){
        kayak.x=width/2; kayak.y=height/2; kayak.tx=kayak.x; kayak.ty=kayak.y; initialized=true;
      }else{
        kayak.x=clamp(kayak.x,0,width); kayak.y=clamp(kayak.y,0,height);
        kayak.tx=clamp(kayak.tx,0,width); kayak.ty=clamp(kayak.ty,0,height);
      }
      targetLength = mobileMQ.matches ? BASE_LENGTH_MOBILE : BASE_LENGTH_DESKTOP;

      if (coin.active){
        const pad = coin.r + 4;
        coin.x = clamp(coin.x, pad, width - pad);
        coin.y = clamp(coin.y, pad, height - pad);
      }
    }
    addEventListener('resize', resize, {passive:true}); resize();

    /* ==========================================================
       WAVES (layered ribbons) + overscale to avoid edge reveals
       ========================================================== */
    const BASE_WAVE_ROT = -Math.PI * 0.375; // NNE→SSW
    let waveRot = BASE_WAVE_ROT;
    let waveRotTarget = BASE_WAVE_ROT;
    const WAVE_ROT_EASE_RATE = 1.25;

    let waveFlowX = 0, waveFlowY = 0;      // slow pattern drift
    const WAVE_FLOW_SPEED = 12;
    const WAVE_FLOW_DECAY = 0.9;

    const waves = {
      thickness: 28,
      baseAmp: 10,
      rowGap: 56,
      speedA: prefersReduce?0:0.55,
      speedB: prefersReduce?0:-0.22,
      dx: 5
    };

    const WAVE_OVERSCALE = 1.9;           // overscale factor for rotated plane
    const EXTRA_ROWS_PAD = 6;             // extra rows above/below

    // Small deterministic "value noise"
    function nrand(i){ let x = Math.sin(i*127.1)*43758.5453; return x - Math.floor(x); }
    function noise1(x, seed=0){
      const s = x*0.015 + seed*19.19;
      const i = Math.floor(s), f = s - i;
      const a = nrand(i*1.3+seed), b = nrand((i+1)*1.3+seed);
      const u = f*f*(3-2*f);
      return a*(1-u) + b*u;
    }
    function yWave(x, base, t, rowSeed){
      const k1 = 2*Math.PI/210, k2 = 2*Math.PI/137, k3 = 2*Math.PI/89;
      const p1 = k1*x + t*waves.speedA + rowSeed*1.3;
      const p2 = k2*x - t*waves.speedB + rowSeed*2.1;
      const p3 = k3*x + t*(waves.speedA*0.37) - rowSeed*0.7;
      const amp = waves.baseAmp * (0.8 + 0.6*noise1(x*0.4 + rowSeed*7));
      const jitter = (noise1(x*0.9 + t*0.15 + rowSeed*3)-0.5)*6;
      return base + (Math.sin(p1)*0.9 + Math.sin(p2)*0.5 + Math.sin(p3)*0.25)*amp + jitter;
    }

    function drawWaves(t){
      ctx.fillStyle = COLOR_LIGHT; ctx.fillRect(0,0,width,height);

      // Ease toward target rotation
      const rotStep = 1 - Math.exp(-WAVE_ROT_EASE_RATE * Math.min(0.033, (timeSec - (lastFrameTime||timeSec))));
      const d = ((waveRotTarget - waveRot + Math.PI) % (2*Math.PI)) - Math.PI;
      waveRot += d * rotStep;

      // Overscaled drawing plane
      const diag = Math.hypot(width, height);
      const W = diag * WAVE_OVERSCALE;
      const H = diag * WAVE_OVERSCALE;
      const yPad = waves.rowGap * EXTRA_ROWS_PAD;

      ctx.save();
      ctx.translate(width/2, height/2);
      ctx.rotate(waveRot);
      ctx.translate(-W/2, -H/2);

      // Slow pattern "flow" in layer space
      ctx.translate(waveFlowX, waveFlowY);

      ctx.fillStyle = COLOR_DARK;
      drawLayer(t, 0.0, waves.rowGap, 0, W, H, yPad);
      ctx.globalAlpha = 0.75;
      drawLayer(t+3.1, waves.rowGap*0.5, waves.rowGap*0.92, 1, W, H, yPad);
      ctx.globalAlpha = 1;
      ctx.restore();
    }
    function drawLayer(t, yOffset, gap, seed, W, H, padY){
      for(let base = yOffset - padY; base < H + padY; base += gap){
        drawRibbon(base, t, seed, W, H);
      }
    }
    function drawRibbon(base, t, seed, W, H){
      const thick = waves.thickness, dx = waves.dx;
      ctx.beginPath();
      let x=0, y=yWave(0, base, t, seed);
      ctx.moveTo(0, y - thick/2);
      for(x=0; x<=W; x+=dx){ y = yWave(x, base, t, seed); ctx.lineTo(x, y - thick/2); }
      for(x=W; x>=0; x-=dx){ y = yWave(x, base, t, seed); ctx.lineTo(x, y + thick/2); }
      ctx.closePath(); ctx.fill();
    }

    /* ==========================================================
       STATE / MOTION HELPERS
       ========================================================== */
    function angDiff(a,b){ let d=(b-a+Math.PI)%(2*Math.PI); if(d<0)d+=2*Math.PI; return d-Math.PI; }
    function approachAngle(a, target, rate, dt){
      const d = angDiff(a, target);
      return a + d * (1 - Math.exp(-rate * dt));
    }

    function setMode(newMode){
      // Kill wake trails when leaving ACTIVE
      if ((mode === MODE.ACTIVE) && (newMode !== MODE.ACTIVE)) {
        wake.points.length = 0;
      }
      mode = newMode;

      // Toggle CSS states used by the logotype outline
      document.body.classList.toggle('idle', mode === MODE.LOGO_IDLE);
      document.body.classList.toggle('recenter', mode === MODE.TRANSITION);

      // Default fade target: logo visible only in idle
      logoAlphaTarget = (mode === MODE.LOGO_IDLE) ? 1 : 0;
    }

    function applyWaveFlowTowardCenter(strength, dt){
      const cx = width/2, cy = height/2;
      const dx = cx - kayak.x, dy = cy - kayak.y;
      const dist = Math.hypot(dx,dy) || 1;
      const vx = dx/dist, vy = dy/dist;
      const cosR = Math.cos(-waveRot), sinR = Math.sin(-waveRot);
      const vrx = vx * cosR - vy * sinR;
      const vry = vx * sinR + vy * cosR;
      waveFlowX += vrx * WAVE_FLOW_SPEED * strength * dt;
      waveFlowY += vry * WAVE_FLOW_SPEED * strength * dt;
      const wrap = waves.rowGap;
      if (waveFlowX >  2*wrap) waveFlowX -= 2*wrap; if (waveFlowX < -2*wrap) waveFlowX += 2*wrap;
      if (waveFlowY >  2*wrap) waveFlowY -= 2*wrap; if (waveFlowY < -2*wrap) waveFlowY += 2*wrap;
    }

    /* ==========================================================
       MAIN BOAT/WAVE UPDATE (per-frame)
       ========================================================== */
    function updateBoatAndWaves(dt){
      // Size easing (mobile/desktop)
      const k = Math.min(1, SIZE_EASE_PER_SEC * dt);
      currentLength += (targetLength - currentLength) * k;

      // Logotype fade easing (separate in/out speeds)
      const fadeRate = (logoAlphaTarget > logoAlpha) ? LOGO_FADE_IN_RATE : LOGO_FADE_OUT_RATE;
      const fadeK = 1 - Math.exp(-fadeRate * dt);
      logoAlpha += (logoAlphaTarget - logoAlpha) * fadeK;
      logoAlpha = clamp(logoAlpha, 0, 1);

      const cx = width/2, cy = height/2;
      const dx = kayak.tx-kayak.x, dy = kayak.ty-kayak.y, dist = Math.hypot(dx,dy);
      const px = kayak.x, py = kayak.y;
      const since = timeSec - lastUserTime;

      if (mode === MODE.ACTIVE){
        // Waves relax back toward base
        const decay = Math.pow(WAVE_FLOW_DECAY, dt);
        waveFlowX *= decay; waveFlowY *= decay;
        waveRotTarget = BASE_WAVE_ROT;

        // Move toward click target
        if (dist > IDLE_DIST){
          const dirX=dx/dist, dirY=dy/dist;
          const desired=Math.min(kayak.maxSpeed, dist*kayak.arriveGain);
          kayak.x += dirX*desired*dt; kayak.y += dirY*desired*dt;

          // Smooth yaw toward travel direction
          const desiredAngle = Math.atan2(dirY,dirX);
          const diff = angDiff(kayak.angle, desiredAngle);
          const maxStep = kayak.turnRate*dt;
          kayak.angle += Math.sign(diff)*Math.min(Math.abs(diff), maxStep);
        }

        // If user idle for a bit and we're at rest, start pre-idle
        if (since >= (IDLE_AFTER - PRE_IDLE_WINDOW) && dist <= IDLE_DIST){
          setMode(MODE.PRE_IDLE);
        }
      }
      else if (mode === MODE.PRE_IDLE){
        // Water starts to "push" gently toward center
        applyWaveFlowTowardCenter(0.8, dt);

        // Tilt waves toward the center bearing (eased)
        const angToCenter = Math.atan2(cy - kayak.y, cx - kayak.x) - Math.PI/2;
        const desiredRot = BASE_WAVE_ROT + clamp(angDiff(BASE_WAVE_ROT, angToCenter), -0.25, 0.25) * 0.25;
        waveRotTarget = approachAngle(waveRotTarget, desiredRot, 0.8, dt);

        // After the full idle window while settled, begin the center transition
        if (since >= IDLE_AFTER && dist <= IDLE_DIST){
          kayak.tx = cx; kayak.ty = cy;
          setMode(MODE.TRANSITION);
          logoAlphaTarget = 1; // start fading the logotype IN during drift-home
        }
      }
      else if (mode === MODE.TRANSITION){
        // Very gentle drift to exact center (several seconds)
        const toCdx = cx-kayak.x, toCdy = cy-kayak.y, toCdist = Math.hypot(toCdx,toCdy);
        const dirX = toCdist>1e-3 ? toCdx/toCdist : 0, dirY = toCdist>1e-3 ? toCdy/toCdist : 0;
        const desired = Math.min(kayak.maxSpeed*0.35, toCdist * (kayak.arriveGain*0.55));
        kayak.x += dirX * desired * dt; kayak.y += dirY * desired * dt;

        // Ease yaw gently back to NORTH
        kayak.angle = approachAngle(kayak.angle, NORTH, 0.35, dt);

        // Waves glide back toward base
        applyWaveFlowTowardCenter(0.9, dt);
        waveRotTarget = approachAngle(waveRotTarget, BASE_WAVE_ROT, 0.6, dt);

        if (toCdist < 1.2){
          setMode(MODE.LOGO_IDLE);
          kayak.x = cx; kayak.y = cy; kayak.angle = NORTH;
        }
      }
      else if (mode === MODE.LOGO_IDLE){
        // Maintain north-facing
        kayak.angle = approachAngle(kayak.angle, NORTH, 0.7, dt);

        // Very slow recenter drift (if nudged off)
        const toCdx = cx-kayak.x, toCdy = cy-kayak.y, toCdist = Math.hypot(toCdx,toCdy);
        if (toCdist > 0.25){
          const dirX = toCdx/toCdist, dirY = toCdy/toCdist;
          const drift = Math.min(0.35, toCdist*0.012);
          kayak.x += dirX * drift * dt; kayak.y += dirY * drift * dt;
        }

        // Idle wobble for waves
        const wobble = 0.12 * Math.sin(timeSec * 0.08);
        const desiredIdleRot = BASE_WAVE_ROT + wobble;
        waveRotTarget = approachAngle(waveRotTarget, desiredIdleRot, 0.45, dt);

        applyWaveFlowTowardCenter(0.3, dt);
      }

      // Update speed (for wake)
      kayak.speed = Math.hypot(kayak.x - px, kayak.y - py) / dt;

      // Push transforms to the overlay DOM
      updateBoatDOM();
    }

    /* ==========================================================
       WAKE (trail)
       ========================================================== */
    function updateWake(dt){
      for (let i=0;i<wake.points.length;i++) wake.points[i].age+=dt;
      while(wake.points.length && wake.points[0].age>wake.maxAge) wake.points.shift();

      const sternOffset = (currentLength/2 - 2);
      if (mode === MODE.ACTIVE && kayak.speed > wake.minSpeed){
        const sx = kayak.x - Math.cos(kayak.angle)*sternOffset;
        const sy = kayak.y - Math.sin(kayak.angle)*sternOffset;
        const last = wake.points[wake.points.length-1];
        const sampleDist = currentLength * 0.028;
        if(!last || Math.hypot(sx-last.x, sy-last.y) >= sampleDist){
          wake.points.push({x:sx,y:sy,age:0});
        }
      }
    }
    function drawWake(){
      const pts=wake.points; if(pts.length<2) return;
      ctx.save(); ctx.strokeStyle='#fff'; ctx.lineCap='round'; ctx.lineJoin='round';
      for(let i=1;i<pts.length;i++){
        const p0=pts[i-1], p1=pts[i];
        const a = Math.min(1 - p0.age/wake.maxAge, 1 - p1.age/wake.maxAge);
        if(a<=0) continue;
        const spreadMax = currentLength * 0.13;

        ctx.globalAlpha=0.18*a*a; ctx.lineWidth=6*a;
        ctx.beginPath(); ctx.moveTo(p0.x,p0.y); ctx.lineTo(p1.x,p1.y); ctx.stroke();

        const vx=p1.x-p0.x, vy=p1.y-p0.y, len=Math.hypot(vx,vy);
        if(len>1e-3){
          const nx=vx/len, ny=vy/len, px=-ny, py=nx;
          const s0=spreadMax*(1 - p0.age/wake.maxAge);
          const s1=spreadMax*(1 - p1.age/wake.maxAge);
          ctx.globalAlpha=0.12*a*a; ctx.lineWidth=3*a;
          ctx.beginPath(); ctx.moveTo(p0.x+px*s0,p0.y+py*s0); ctx.lineTo(p1.x+px*s1,p1.y+py*s1); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(p0.x-px*s0,p0.y-py*s0); ctx.lineTo(p1.x-px*s1,p1.y-py*s1); ctx.stroke();
        }
      }
      ctx.restore();
    }

    /* ==========================================================
       BOAT DOM OVERLAY (position + yaw + sizes)
       ========================================================== */
    const boatEl = document.getElementById('boat');
    const svgKayak = document.getElementById('svgKayak');
    const svgLogo  = document.getElementById('svgLogotype');

    const LOGO_VB_W=1080, LOGO_VB_H=1050;
    const KAYAK_VB_W=4500, KAYAK_VB_H=4375;

    function updateBoatDOM(){
      const heave = Math.sin(timeSec * kayak.rollSpeed * 2*Math.PI) * kayak.heaveAmp;
      const roll  = Math.sin(timeSec * kayak.rollSpeed * 2*Math.PI) * kayak.rollAmp;

      boatEl.style.transform =
        `translate(${kayak.x}px, ${kayak.y + heave}px) rotate(${(kayak.angle + roll) * 180/Math.PI}deg)`;

      const L = currentLength;
      const kayakW = L * (KAYAK_VB_W / KAYAK_VB_H);
      const logoW  = L * (LOGO_VB_W / LOGO_VB_H);
      svgKayak.style.width = kayakW + 'px'; svgKayak.style.height = L + 'px';
      svgLogo.style.width  = logoW + 'px';  svgLogo.style.height  = L + 'px';

      svgLogo.style.opacity = logoAlpha;
    }

    /* ==========================================================
       RIPPLE (click feedback)
       ========================================================== */
    const ripple={x:0,y:0,t0:-10};
    function drawRipple(t){
      const e=t-ripple.t0; if(e<0||e>1.2) return;
      const a=1-(e/1.2);
      ctx.save(); ctx.translate(ripple.x,ripple.y); ctx.strokeStyle=COLOR_DARK; ctx.globalAlpha=0.35*a; ctx.lineWidth=2;
      circle(e*140); circle(16+e*180); ctx.restore();
      function circle(r){ ctx.beginPath(); ctx.arc(0,0,r,0,Math.PI*2); ctx.stroke(); }
    }

    /* ==========================================================
       COINS: SPAWN / DESPAWN / DRAW / PICKUP EFFECT
       ========================================================== */
    const pickupFX = { t0:-10, x:0, y:0 };

    function spawnCoin(){
      const pad = 40;
      coin.r = mobileMQ.matches ? 12 : 16;
      coin.x = pad + Math.random()*(width - pad*2);
      coin.y = pad + Math.random()*(height - pad*2);
      coin.active = true;
      coin.spawnAt = timeSec;
      coin.expiresAt = timeSec + randSpan(); // 6–9s lifetime
      coin.targeted = false;
    }

    function collectCoin(){
      pickupFX.t0 = timeSec; pickupFX.x = coin.x; pickupFX.y = coin.y;
      coin.active = false; coin.targeted=false;

      score++;
      scoreCount.textContent = String(score);
      if (score > 0) { showCard(cardCoinsEl); scheduleHideCard(cardCoinsEl, 'coins'); }

      nextSpawnAt = timeSec + randSpan();
    }

    function updateCoin(dt){
      // Spawning is gated until the first user click
      if(coinsEnabled && !coin.active && timeSec >= nextSpawnAt){
        spawnCoin();
        nextSpawnAt = Number.POSITIVE_INFINITY; // schedule after resolve
      }

      // Expiry => miss
      if(coin.active && timeSec >= coin.expiresAt){
        coin.active = false;
        missed++;
        missCountEl.textContent = String(missed);
        if (missed > 0) { showCard(cardMissEl); scheduleHideCard(cardMissEl, 'miss'); }
        nextSpawnAt = timeSec + randSpan();
      }

      // Auto collect if close enough
      if(coin.active){
        const threshold = coin.r + currentLength*0.38;
        const dx = kayak.x - coin.x, dy = kayak.y - coin.y;
        if(Math.hypot(dx,dy) <= threshold){
          collectCoin();
        }
      }
    }

    function drawCoin(t){
      if(!coin.active) return;
      const r = coin.r * (1 + 0.08 * Math.sin((t - coin.spawnAt) * 6.0));
      ctx.save();
      const grad = ctx.createRadialGradient(coin.x - r*0.25, coin.y - r*0.25, r*0.1, coin.x, coin.y, r);
      grad.addColorStop(0, '#FFE680'); grad.addColorStop(0.6, '#F5C542'); grad.addColorStop(1, '#D39A00');
      ctx.beginPath(); ctx.arc(coin.x, coin.y, r, 0, Math.PI*2);
      ctx.fillStyle = grad; ctx.fill();
      ctx.lineWidth = 2; ctx.strokeStyle = '#906A00'; ctx.stroke();
      ctx.globalAlpha = 0.45; ctx.beginPath(); ctx.arc(coin.x - r*0.25, coin.y - r*0.3, r*0.35, 0, Math.PI*2); ctx.fillStyle = '#FFFFFF'; ctx.fill();
      ctx.restore();
    }

    function drawPickupFX(t){
      const e=t-pickupFX.t0; if(e<0||e>0.6) return;
      const a=1 - e/0.6; const r=8 + e*60;
      ctx.save(); ctx.translate(pickupFX.x, pickupFX.y); ctx.globalAlpha=0.35*a; ctx.strokeStyle='#fff'; ctx.lineWidth=2;
      ctx.beginPath(); ctx.arc(0,0,r,0,Math.PI*2); ctx.stroke();
      ctx.restore();
    }

    /* ==========================================================
       INPUT ROUTING
       - Any click (anywhere) moves the kayak.
       - We use global pointer handlers (capture) so overlay/panels/buttons still move the boat.
       ========================================================== */
    const hint = document.getElementById('hint');
    let hintTimer=null;
    function scheduleHint(){
      if(hintTimer) clearTimeout(hintTimer);
      hint.classList.remove('show');
      hintTimer = setTimeout(()=>hint.classList.add('show'), 30000);
    }
    scheduleHint();

    let pointerDown=false, pointerPresent=false, pointerX=0, pointerY=0, suppressNextUp=false;

    function canvasToLocal(e){
      const r = canvas.getBoundingClientRect();
      return { x: e.clientX - r.left, y: e.clientY - r.top };
    }
    function moveBoatTo(x,y){
      kayak.tx=x; kayak.ty=y;
      ripple.x=x; ripple.y=y; ripple.t0=timeSec;
    }
    function coinHit(x,y){
      if(!coin.active) return false;
      const dx = x - coin.x, dy = y - coin.y;
      return Math.hypot(dx,dy) <= coin.r * 1.25;
    }

    // Unified press/release handlers so UI clicks still move the boat
    function onPressAt(x,y){
      pointerDown = true; pointerPresent=true; lastUserTime = timeSec;

      if (coinHit(x,y)){
        suppressNextUp = true;
        setMode(MODE.ACTIVE);
        logoAlphaTarget = 0;
        moveBoatTo(coin.x, coin.y);
        coin.targeted = true;
      } else {
        if (mode !== MODE.LOGO_IDLE){
          moveBoatTo(x, y);
          setMode(MODE.ACTIVE);
          logoAlphaTarget = 0;  // fade logotype OUT (~1s)
        } else {
          setMode(MODE.ACTIVE);
          logoAlphaTarget = 0;
          moveBoatTo(x, y);
        }
      }

      hint.classList.remove('show');
      scheduleHint();
    }
    function onReleaseAt(x,y){
      pointerDown = false; lastUserTime = timeSec;

      if (!coinsEnabled){             // first click enables coin loop
        coinsEnabled = true;
        nextSpawnAt = timeSec + randSpan();
      }

      if (suppressNextUp){ suppressNextUp=false; return; }

      if (mode === MODE.LOGO_IDLE){
        setMode(MODE.ACTIVE);
        logoAlphaTarget = 0;
        moveBoatTo(x, y);
      } else if (mode === MODE.ACTIVE){
        moveBoatTo(x, y);
      }
    }

    // Global pointer listeners (capture = before bubbling)
    document.addEventListener('pointermove', (e)=>{
      const p=canvasToLocal(e); pointerX=p.x; pointerY=p.y; pointerPresent=true;
    }, {passive:true, capture:true});

    document.addEventListener('pointerdown', (e)=>{
      const p=canvasToLocal(e); pointerX=p.x; pointerY=p.y; pointerPresent=true;
      onPressAt(p.x, p.y);
    }, {passive:true, capture:true});

    document.addEventListener('pointerup', (e)=>{
      const p=canvasToLocal(e); pointerX=p.x; pointerY=p.y;
      onReleaseAt(p.x, p.y);
    }, {passive:true, capture:true});

    document.addEventListener('pointercancel',()=>{ pointerDown=false; pointerPresent=false; });

    // Cursor attraction: now SAFE for ACTIVE/PRE_IDLE (keeps tx,ty in sync so it doesn't block pre-idle)
    function cursorAttraction(dt){
      if (!pointerPresent) return;
      if (mode === MODE.TRANSITION) return; // don't interfere with drift-home

      const movingToClick = (mode === MODE.ACTIVE) && (Math.hypot(kayak.tx-kayak.x, kayak.ty-kayak.y) > IDLE_DIST);
      const allowBias = (mode === MODE.LOGO_IDLE) || (mode === MODE.PRE_IDLE) || (mode === MODE.ACTIVE && !movingToClick);
      if (!allowBias) return;

      const dx = pointerX - kayak.x, dy = pointerY - kayak.y;
      const dist = Math.hypot(dx,dy); if (dist < 1) return;
      const dirX = dx/dist, dirY = dy/dist;

      const biasSpeed = pointerDown ? 36 : 12;
      const modeFactor = (mode === MODE.PRE_IDLE) ? 0.6 : 1.0;
      const dX = dirX * biasSpeed * modeFactor * dt;
      const dY = dirY * biasSpeed * modeFactor * dt;

      // Move the boat...
      kayak.x += dX; kayak.y += dY;

      // ...and keep the target in lockstep unless we're LOGO_IDLE 
      // (in idle, we want it to drift back to center naturally).
      if (mode !== MODE.LOGO_IDLE){
        kayak.tx += dX; kayak.ty += dY; // keeps dist≈0 so pre-idle can still trigger
      }
    }

    // Pause hint timer when tab hidden
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) { if (hintTimer) clearTimeout(hintTimer); }
      else { scheduleHint(); }
    });

    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    /* ==========================================================
       INFO OVERLAY OPEN/CLOSE (any click still moves kayak)
       ========================================================== */
    const infoBtn    = document.getElementById('infoBtn');
    const infoOverlay= document.getElementById('infoOverlay');
    const infoPanel  = document.getElementById('infoPanel');
    const infoClose  = document.getElementById('infoClose');

    function openInfo(){ infoOverlay.classList.add('show'); }
    function closeInfo(){ infoOverlay.classList.remove('show'); }

    infoBtn.addEventListener('click', (e)=>{ openInfo(); });
    infoClose.addEventListener('click', (e)=>{ closeInfo(); });

    // Clicking on the overlay background (not the panel) closes it
    infoOverlay.addEventListener('pointerdown', (e)=>{
      if (e.target === infoOverlay) closeInfo();
    }, {passive:true});

    /* ==========================================================
       EMAIL SIGNUP — simple mailto stub
       ========================================================== */
    const signup     = document.getElementById('signup');
    const emailInput = document.getElementById('email');

    signup.addEventListener('submit', (e)=>{
      e.preventDefault();
      const addr = (emailInput.value || '').trim();
      const subj = encodeURIComponent('Subscribe me to BakYak');
      const body = encodeURIComponent(`Please add me to the early list.\nMy email: ${addr || '(entered on page)'}`);
      window.location.href = `mailto:subscribe@bakyak.ca?subject=${subj}&body=${body}`;
    });

    /* ==========================================================
       MAIN LOOP
       ========================================================== */
    let lastFrameTime = timeSec;
    function frame(now){
      const dt=Math.min(0.033,(now-last)/1000); last=now; timeSec+=dt;

      updateBoatAndWaves(dt);
      cursorAttraction(dt);   // gentle pull toward pointer (now pre-idle safe)
      updateWake(dt);
      updateCoin(dt);

      drawWaves(timeSec);
      drawWake();
      drawRipple(timeSec);
      drawPickupFX(timeSec);
      drawCoin(timeSec);

      lastFrameTime = timeSec;
      requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  })();
  </script>

  <!-- Simple structured data -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Organization","name":"Bak-Yak Inc.","alternateName":"BakYak","url":"https://bakyak.ca","logo":"https://bakyak.ca/assets/logotype.svg"}
  </script>
</body>
</html>
